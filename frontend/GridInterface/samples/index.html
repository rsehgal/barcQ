<html>
<head>
	<style type="text/css">
	</style>
    <header>
        <title> BARCQ </title>
    </header>
<link rel="stylesheet" href="../../css/tabstyle.css">
<link rel="stylesheet" href="../../css/grid.css">
<link rel="stylesheet" href="../../css/popup.css">

	<script src = "../../jsonschemas/allowedUserDefinedGate.json"></script>
	<script src = "../../jsonschemas/gatesUIExtended.json"></script>
	<script src = '../../js/jquery.js'> </script>
    <script src = '../../js/jquery-ui.js'> </script>
    <script src="../../js/createdropzone.js"></script>
    <script src = "../../js/globalvars.js"></script>
    <script src = "../../js/toolbox_v2.js"></script>
    <script src = "../../js/cloneanddrag_v2.js"></script>
    <script src = "../../js/selectanddelete.js"></script>
    <script src = "../../js/mergeandunmerge.js"></script>
	<script src = "../../js/gridtojson.js"></script>
	<script src = "../../js/savefile.js"></script>
    <script src = "../../js/core.js"></script>
	<script src = "../../js/loadjson.js"></script>
	<script src = "../../js/loadfile.js"></script>
    <script src = "../../js/d3.v3.min.js"></script>
    <script src = "../../js/gridinputlines.js"></script>
    <script src = "../../js/redesigngrid.js"></script>
    <script src = "../../js/gatessymbol.js"></script>
    <script src = "../../js/userdefinedcontrolgates.js"></script>
	<script src = "../../js/checkdiv.js"></script>
	<script src="../../js/tabbedInterface.js"></script>
	<script src="../../js/plotly-latest.min.js"></script>
	    <script>
	    $(document).ready(function(){
	    	CreateToolBox();
	    	CreateDropzone();
	    	//MakeCloneAble();
	    	//AttachSelectAndDelete();
			 AttachDraggableEvents();
             AttachDroppableEvents();
             console.log("************* Executing Core TEst *************");
	    	CoreTest();
	    	console.log("******************************************");
	    	$("#mergebutton").click(function(){
        	    GridToJson();
 			});
 			/*$("#loadbutton").click(function(){
        	    loadFile();
 			});*/
 			AddInputLinesToGrid();
 			InsertConnectorOnGrid();
 			ControlGateInitialization();
 			$("#create").click(function(){
 				StoreDivIds();	
 			});
 			
 			//----------------------------------
 			$(".trigger_popup_fricc").click(function(){
				$('.hover_bkgr_fricc').show();
			});
			
			/*$('.hover_bkgr_fricc').click(function(){
				//  $('.hover_bkgr_fricc').hide();
			});
			$('.popupCloseButton').click(function(){
					$('.hover_bkgr_fricc').hide();
			});
			$('.popupSetButton').click(function(){
				//Set the required variable and hide
				ctl_bits_array=$("#ctl_bits_field").val().split(",");
				unitaryControlRowIds=ctl_bits_array;
				//alert("Length of ctl array : "+ctl_bits_array.length )
				tgt_bits_array=$("#tgt_bits_field").val().split(",");
				unitaryTargetRowIds=tgt_bits_array;
				//alert("Length of tgt array : "+tgt_bits_array.length )
				//alert("Num_bits : "+(ctl_bits_array.length+tgt_bits_array.length))
				$('.hover_bkgr_fricc').hide();
				UpdateGenericControlGate();
			});*/

			$('.hover_bkgr_fricc').click(function(){
                //  $('.hover_bkgr_fricc').hide();
            });
            $('.popupCloseButton').click(function(){
                    $('.hover_bkgr_fricc').hide();
            });
            //$('.popupSetButton').click(function(){
            $('#gateSetButton').click(function(){
                //Set the required variable and hide
                ctl_bits_array=$("#ctl_bits_field").val().split(",");
                unitaryControlRowIds=ctl_bits_array;
                //alert("Length of ctl array : "+ctl_bits_array.length )
                tgt_bits_array=$("#tgt_bits_field").val().split(",");
                unitaryTargetRowIds=tgt_bits_array;
                //alert("Length of tgt array : "+tgt_bits_array.length )
                //alert("Num_bits : "+(ctl_bits_array.length+tgt_bits_array.length))
                $('.hover_bkgr_fricc').hide();
                //UpdateGenericControlGate(obj);
                UpdateGenericControlGate();
            });
            
            $('#phaseSetButton').click(function(){
					gateObj.attr("arg_value",$("#phase_field").val());
					$('.hover_bkgr_fricc').hide();
					ModifyParentDiv(gateObj.parent());
					GenerateCode();
			});
            
			//-----------------------------------------

 			//Trying to call server side function written in cherryPy
 			$("#submitButton").click(function(e){
                        $.post("/CodeGenerator",{"jsonObj" : JSON.stringify(circuitJsonObj)},function(data) {
                			console.log("Reverse function calle........");
                			data=JSON.parse(data);
                			console.log("---- Printing returned JSON ----")
                			console.log(data);
                            //$("#title").html(data["title"]) ;
                            console.log("Plot X : "+data["xdata"])
                            console.log("Plot Y : "+data["ydata"])
                            $("#title").html(data["ydata"]) ;
                            //xdata=data["xdata"];
                            xStringData=[]
                            for(var index=0;index<data["xdata"].length;index++){

                            	xStringData.push(data["xdata"][index]+"t");

                            }

                            sumData[0]["x"]=xStringData; //data["xdata"].toString();
                            sumData[0]["y"]=data["ydata"];
               	})
                 .done(function() {
               		console.log("Server side function called........");
            	});
           	e.preventDefault();

            /*
			//This also works, keeping it just for the future reference
            var request = $.ajax({'url': '/CodeGenerator'});
           	request.done(function(response) {
		        //$('#foo').text(response.foo);
		        //$('#baz').text(response.baz);
		        console.log("Data Received : "+response);
		        $("#title").html(response);
		      });*/

            });

 			
		});
	</script>
</head>

<body id="body">


	<!-- Trying to create tabbed interface 	-->
	<h2>Welcome to BARCQ</h2>
	<!-- <p>Click on the buttons inside the tabbed menu:</p> -->
	<div class="tab">
  		<button class="tablinks" onclick="openCity(event, 'circuitComposer')">Circuit Editor</button>
  		<button class="tablinks" onclick="openCity(event, 'qutipCode')">QuTiP code</button>
  		<button class="tablinks" onclick="openCity(event, 'results')">Results</button>
  		<button class="tablinks" onclick="openCity(event, 'help')">Help</button>
	  </div>
	<!--<footer>
		<div>
			<p> Please send your feedback to <a href="mailto:supratim@barc.gov.in"> Team BARCQ</a>. </p>
		</div>
	</footer>-->
	<div id="circuitComposer" class="tabcontent">
	<table>
		<tr> 
			<td>
				<div id="toolboxDivSingle" class="toolbox"></div>
			</td>
			<td>
				<div id="toolboxDivMultiple" class="toolbox"></div>
			</td>
			<td style="vertical-align: top;">
			<div id="parentForOverlappingDiv">
				<div id="linesDiv" class="box"></div>
				<div id="svgDropDiv" class="box stack-top" >
					<svg xmlns="http://www.w3.org/2000/svg" id="testSvg" width=100% height=100%>
						<g id="testGroup">
  							<foreignObject x="0" y="0" width=100% height=100% >
								<div id="dropzoneDiv" width=100% height=100% ></div>
							</foreignObject>
						</g>
					</svg>
				</div>
				
			</div>
			</td>
		</tr>
	</table>
	
<!--	<button type="button" id="mergebutton">Export JSON</button>-->
<!--    <input type="file" id="fileLoader" style="display: none" />-->
	<button type="button" id="savefile">Save Circuit</button>
	<button type="button" id="loadbutton" onclick="loadFile()">Load Circuit</button>
	<button onclick="window.print()">PrintThisPage</button>
	<button type="button" disabled id="create">New Controlled Gate</button>
	<button type="button" disabled id="display">Create Gate</button>
	<button type="button" id="submitButton" class="button"><b>Submit</b></button>
	<h3 id = "title"></h3>
	<footer>
		<div>
			<p> Please send your feedback to <a href="mailto:supratim@barc.gov.in"> Team BARCQ</a>. </p>
		</div>
	</footer>


</div>

<div id="qutipCode" class="tabcontent monospace"></div>

<div id="results"  class="tabcontent">
<!-- For each new plot, just add a div below -->
	<div id="plotHist"></div>
	<div id="countPlot"></div>
	<div id="sumPlot"></div>
</div>
<div id="help"  class="tabcontent">
	<h2> Getting Started</h2>
	<p><h4>Everything starts from Circuit Editor!</h4></p>
	<p>Open Circuit Editor. The left pane is the component panel. It shows the collection of components/gates at your disposal for designing the circuit.</p>
	<p>The grid on the right is the editor panel where you will create your circuit. Each horizontal line in this panel represents a qubit. Use left mouse button to drag
		and drop any gate from the component panel to the editor panel. Remember to drop the components on the small circles in the editor panel. Components will snap to the grid only on those circles.
	</p>
	<p>Once your circuit is ready, press the Submit button (at the bottom of the page). Output will be available under the Results tab</p>
	<p>There is a Save Circuit button at the bottom of the page for saving the circuit in your local computer. Depending on your browser settings, either it will ask for a location to save the file or it will save in some default location (already set in your browser; most likely the Download folder if your OS is Windows)</p>
	<p>The Load Circuit button loads a previously saved circuit. But it has some bug! So it is not very useful at present.</p>
	<p>You can print the whole page using PrintThisPage button</p>
	<p>Under the Results tab, you have access to the following features: </p>
	<p>Download the plot as a png file</p>
	<p>Zoom in and Zoom out</p>
	<p>Auto Scale</p>
	<p>Reset Axes</p>
	<p>Show closest data on hover</p>
	<p>Compare data on hover</p>
	<p>****************************************************************************************************************************</p>
	<p><h5>A few easy tricks</h5></p>
	<p>Refresh the page if something is not working as expected.</p>
	<p>Clear cache if you get some error message and refreshing the page is not helping.</p>
	<p>****************************************************************************************************************************</p>
	<p><h5>Coming Soon</h5></p>
	<p>Examples</p>
	<p>****************************************************************************************************************************</p>
	<footer>
		<div>
			<p><h4>Experiment and Explore</h4></p>
			<p> Please send your feedback to <a href="mailto:supratim@barc.gov.in">supratim@barc.gov.in</a>. </p>
		</div>
	</footer>
	

	
</div>	
<div class="hover_bkgr_fricc" id="gatePopup">
    <span class="helper"></span>
    <div>
        <div class="popupCloseButton">&times;</div>
        <!-- <p>Add any HTML content<br />inside the popup box!</p> -->
        <!-- Num of bits <input type="text" size="5"/><br/> -->
        <label id="ctl_label">Control bits</label> <input type="text" size="5" placeholder="1,2,3" bits id="ctl_bits_field"/><br/>
        <label id="tgt_label">Target bits</label> <input type="text" size="5" placeholder="1,2" bits  id="tgt_bits_field"/><br/>
        <div class="popupSetButton" id="gateSetButton">&#10004;</div>
    </div>
</div>

<div class="hover_bkgr_fricc"  id="phasePopup">
    <span class="helper"></span>
    <div>
        <div class="popupCloseButton">&times;</div>
        Theta <input type="text" size="5" placeholder="3.14159" bits id="phase_field"/><br/>
        <div class="popupSetButton" id="phaseSetButton">&#10004;</div>
    </div>
</div>

</body>

</html>
